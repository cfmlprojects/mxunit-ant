<?xml version="1.0"?>

<project xmlns:au="antlib:org.apache.ant.antunit"
          xmlns="antlib:org.apache.tools.ant" >

	<property name="svn.test.dir" location="./svnTest" />
	<available file="${svn.test.dir}" property="svntest.is.available" />

	<target name="_checkout_ifnot" unless="svntest.is.available">
		<svn username="${username}" password="${password}">
			<checkout url="https://mxunit.googlecode.com/svn/mxunit/branches/sandbox" recurse="false" destPath="${svn.test.dir}" />
		</svn>
	</target>

	<target name="testCommit" depends="_checkout_ifnot">
		<touch file="svnTest/Application.cfm" datetime="07/05/2007 6:00 am"/>
		<svn username="${username}" password="${password}">
			<commit message="Testing Commit for MXUnit Sandbox" dir="${svn.test.dir}" recurse="true" />
			<status path="${svn.test.dir}/Application.cfm" 
            textStatusProperty="testStatus.textStatus" 
            propStatusProperty="testStatus.propStatus" 
            lastChangedRevisionProperty="testStatus.lastCommitRevision" 
            revisionProperty="testStatus.revision" 
            lastCommitAuthorProperty="testStatus.lastCommitAuthor" />
		</svn>

		<au:assertPropertyEquals name="testStatus.lastCommitAuthor" value="virtix"  />
		<au:assertPropertyEquals name="testStatus.textStatus" value="normal"  />

		<au:expectfailure>
			<au:assertPropertyEquals name="testStatus.lastCommitAuthor" value="joe"  />
		</au:expectfailure>

	</target>


	<target name="setUp">
		<!-- for log assertions -->
		<au:logcontent level="verbose" />

		<path id="project.classpath">
			<pathelement location="lib/svnjavahl.jar" />
			<pathelement location="lib/svnant.jar/" />
			<pathelement location="lib/svnClientAdapter.jar/" />
		</path>
		<property file="testprops.properties" />
		<!-- load the svn task -->
		<taskdef name="svn" classname="org.tigris.subversion.svnant.SvnTask" classpathref="project.classpath"/>
	</target>


	<!-- clean up -->
	<target name="tearDown">
		<!-- clean up -->
	</target>


</project>

